# Unsupervised Learning

```{r, echo = FALSE, message = FALSE}
source(here::here("scripts/setup.R"))
```

## Clustering

xxx


## PCA

```{r, echo=FALSE}
PLR.numeric <- premier_league_results %>% dplyr::select(where(is.numeric))
PLR.pca <- PCA(PLR.numeric, ncp = 11, graph = FALSE)

PLR.pca
```

```{r, echo=FALSE}
fviz_pca_var(PLR.pca)
```


```{r, echo=FALSE}
# Extract the contributions of each features in the dimension.
fviz_contrib(PLR.pca, choice = "var", axes = 1) #aes determines which dimension
```

```{r, echo=FALSE}
fviz_pca_ind(PLR.pca) ## only the individuals
fviz_pca_biplot(PLR.pca) ## biplot
```


```{r, echo=FALSE}
fviz_eig(PLR.pca, addlabels = TRUE, ncp=11)
```


```{r, echo=FALSE}
p1 <- fviz_pca_biplot(PLR.pca, axes = 1:2) 
p2 <- fviz_pca_biplot(PLR.pca, axes = 3:4) 
p3 <- fviz_pca_biplot(PLR.pca, axes = 5:6) 
grid.arrange(p1, p2, p3, nrow = 2, ncol=2)
```

```{r, echo=FALSE}
#to be fixed
PLR.hc <- hclust(dist(premier_league_results, method = "manhattan"))
PLR.clust <- cutree(PLR.hc, k = 6)
fviz_pca_biplot(PLR.pca,
             col.ind = factor(PLR.clust))
```

## Unsupervised Learning Findings

xxx