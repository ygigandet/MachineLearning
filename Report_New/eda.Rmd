# Exploratory Data Analysis (EDA)

```{r, echo = FALSE, message = FALSE}
source(here::here("scripts/setup.R"))
```

```{r}
#  Load the cleaned dataset from the data.Rmd
setwd(here::here("Data_New/"))
premier_league_results <- read_csv("premier_league_results_clean.csv")
```

## Premier League Results

##Single variable Analysis

```{r, echo=FALSE}
str(premier_league_results)
```

## Multivariate Analysis


### Premiere League Results 2017-2018

```{r, echo=FALSE}
PLR17 <- premier_league_results %>% mutate(year= paste(20,substr(match_date, 7, 8), sep = ""), .after = match_date )
```

```{r, echo=FALSE}
data_frame(PLR17$full_time_home_goals, PLR17$full_time_away_goals, PLR17$full_time_results, PLR17$home_shots, PLR17$away_shots, PLR17$home_fouls, PLR17$away_fouls, PLR17$home_yellow_cards, PLR17$away_yellow_cards, PLR17$home_red_cards, PLR17$away_red_cards) %>%
  plot_histogram(ncol = 3)
```



```{r, echo=FALSE}
data_frame(PLR17$full_time_home_goals, PLR17$full_time_away_goals, PLR17$full_time_results, PLR17$home_shots, PLR17$away_shots, PLR17$home_fouls, PLR17$away_fouls, PLR17$home_yellow_cards, PLR17$away_yellow_cards, PLR17$home_red_cards, PLR17$away_red_cards) %>%
  plot_density(ncol = 3)
```


```{r, echo=FALSE}

```

```{r, echo=FALSE}
data_frame(premier_league_results$full_time_home_goals, premier_league_results$full_time_away_goals, premier_league_results$full_time_results, premier_league_results$home_shots, premier_league_results$away_shots, premier_league_results$home_fouls, premier_league_results$away_fouls, premier_league_results$home_yellow_cards, premier_league_results$away_yellow_cards, premier_league_results$home_red_cards, premier_league_results$away_red_cards) %>%
  plot_histogram(ncol = 3)
```


```{r, echo=FALSE}
data_frame(premier_league_results$full_time_home_goals, premier_league_results$full_time_away_goals, premier_league_results$full_time_results, premier_league_results$home_shots, premier_league_results$away_shots, premier_league_results$home_fouls, premier_league_results$away_fouls, premier_league_results$home_yellow_cards, premier_league_results$away_yellow_cards, premier_league_results$home_red_cards, premier_league_results$away_red_cards) %>%
  plot_density(ncol = 3)
```


```{r, echo=FALSE}
#might remove
data_frame(premier_league_results$full_time_home_goals, premier_league_results$full_time_away_goals, premier_league_results$home_shots, premier_league_results$away_shots, premier_league_results$home_fouls, premier_league_results$away_fouls, premier_league_results$home_yellow_cards, premier_league_results$away_yellow_cards, premier_league_results$home_red_cards, premier_league_results$away_red_cards) %>%
  plot_correlation()
```

```{r, echo=FALSE}
premier_league_results$year <- 
```


```{r, echo=FALSE}

```

```{r, echo=FALSE}

```

```{r, echo=FALSE}

```


```{r, echo=FALSE}
premier_league_results %>%
  group_by(full_time_results, home_team) %>% summarise(counts = n(), .groups = 'drop') %>%
  plot_ly(x = ~home_team, y = ~counts, type = 'bar', color = ~full_time_results, height = 1000, width = 600) %>%
  layout(title= 'Number of wins when Home', barmode = 'stack' )
```

```{r, echo=FALSE}

home_team_results <- ggplot(data=premier_league_results, aes(x=home_team, y=full_time_results, fill=full_time_results)) +
  geom_bar(stat="identity")+
  scale_fill_brewer(palette="Blues")+
  geom_text(aes(label=full_time_home_goals), vjust=1.6, color="white",
            position = position_dodge(0.9), size=3.5)
home_team_results

away_team_results <- ggplot(data=premier_league_results, aes(x=home_team, y=away_team)) +
  geom_point(aes(colour = factor(result)))

away_team_results
```

