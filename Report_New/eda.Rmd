# Exploratory Data Analysis (EDA)

```{r, echo = FALSE, message = FALSE}
source(here::here("scripts/setup.R"))
```

```{r}
#  Load the cleaned dataset from the data.Rmd
setwd(here::here("Data_New/"))
premier_league_results <- read_csv("premier_league_results_clean.csv")
```

## Premier League Results

##Single variable Analysis

```{r, echo=FALSE}
str(premier_league_results)
```

## Multivariate Analysis


### Premiere League Results 2017-2018

```{r, echo=FALSE}
premier_league_results <- premier_league_results %>% mutate(year= paste(20,substr(match_date, 7, 8), sep = ""), .after = match_date )
```


```{r, echo=FALSE}
PLR17 <- premier_league_results %>% filter(year <=2017)
```

```{r, echo=FALSE}
data_frame(PLR17$full_time_home_goals, PLR17$full_time_away_goals, PLR17$full_time_results, PLR17$home_shots, PLR17$away_shots, PLR17$home_fouls, PLR17$away_fouls, PLR17$home_yellow_cards, PLR17$away_yellow_cards, PLR17$home_red_cards, PLR17$away_red_cards) %>%
  plot_histogram(ncol = 3)
```



```{r, echo=FALSE}
data_frame(PLR17$full_time_home_goals, PLR17$full_time_away_goals, PLR17$full_time_results, PLR17$home_shots, PLR17$away_shots, PLR17$home_fouls, PLR17$away_fouls, PLR17$home_yellow_cards, PLR17$away_yellow_cards, PLR17$home_red_cards, PLR17$away_red_cards) %>%
  plot_density(ncol = 3)
```

```{r, echo=FALSE}
data_frame(PLR17$full_time_home_goals, PLR17$full_time_away_goals, PLR17$full_time_results, PLR17$home_shots, PLR17$away_shots, PLR17$home_fouls, PLR17$away_fouls, PLR17$home_yellow_cards, PLR17$away_yellow_cards, PLR17$home_red_cards, PLR17$away_red_cards) %>%
  plot_correlation()
```

```{r, echo=FALSE}
PLR17 %>%
  group_by(home_team, full_time_results) %>% summarise(counts = n(), .groups = 'drop') %>%
  plot_ly(x = ~home_team, y = ~counts, type = 'bar', color = ~full_time_results, height = 500, width = 1000) %>%
  layout(title= 'Number of wins when Home 17-18', barmode = 'stack' )
```


```{r, echo=FALSE}
PLR17 %>%
  group_by(away_team, full_time_results) %>% summarise(counts = n(), .groups = 'drop') %>%
  plot_ly(x = ~away_team, y = ~counts, type = 'bar', color = ~full_time_results, height = 500, width = 1000) %>%
  layout(title= 'Number of wins when Away 17-18', barmode = 'stack' )
```


### Premiere League Results 2017-2018


```{r, echo=FALSE}
PLR18 <- premier_league_results %>% filter(year >=2018)
```

```{r, echo=FALSE}
data_frame(PLR18$full_time_home_goals, PLR18$full_time_away_goals, PLR18$full_time_results, PLR18$home_shots, PLR18$away_shots, PLR18$home_fouls, PLR18$away_fouls, PLR18$home_yellow_cards, PLR18$away_yellow_cards, PLR18$home_red_cards, PLR18$away_red_cards) %>%
  plot_histogram(ncol = 3)
```


```{r, echo=FALSE}
data_frame(PLR18$full_time_home_goals, PLR18$full_time_away_goals, PLR18$full_time_results, PLR18$home_shots, PLR18$away_shots, PLR18$home_fouls, PLR18$away_fouls, PLR18$home_yellow_cards, PLR18$away_yellow_cards, PLR18$home_red_cards, PLR18$away_red_cards) %>%
  plot_density(ncol = 3)
```

```{r, echo=FALSE}
data_frame(PLR18$full_time_home_goals, PLR18$full_time_away_goals, PLR18$full_time_results, PLR18$home_shots, PLR18$away_shots, PLR18$home_fouls, PLR18$away_fouls, PLR18$home_yellow_cards, PLR18$away_yellow_cards, PLR18$home_red_cards, PLR18$away_red_cards) %>%
  plot_correlation()
```


```{r, echo=FALSE}
PLR18 %>%
  group_by(home_team, full_time_results) %>% summarise(counts = n(), .groups = 'drop') %>%
  plot_ly(x = ~home_team, y = ~counts, type = 'bar', color = ~full_time_results, height = 500, width = 1000) %>%
  layout(title= 'Number of wins when Home 18-19', barmode = 'stack' )
```


```{r, echo=FALSE}
PLR18 %>%
  group_by(away_team, full_time_results) %>% summarise(counts = n(), .groups = 'drop') %>%
  plot_ly(x = ~away_team, y = ~counts, type = 'bar', color = ~full_time_results, height = 500, width = 1000) %>%
  layout(title= 'Number of wins when Away 18-19', barmode = 'stack' )
```








```{r, echo=FALSE}
data_frame(premier_league_results$full_time_home_goals, premier_league_results$full_time_away_goals, premier_league_results$full_time_results, premier_league_results$home_shots, premier_league_results$away_shots, premier_league_results$home_fouls, premier_league_results$away_fouls, premier_league_results$home_yellow_cards, premier_league_results$away_yellow_cards, premier_league_results$home_red_cards, premier_league_results$away_red_cards) %>%
  plot_histogram(ncol = 3)
```





```{r, echo=FALSE}
data_frame(premier_league_results$full_time_home_goals, premier_league_results$full_time_away_goals, premier_league_results$full_time_results, premier_league_results$home_shots, premier_league_results$away_shots, premier_league_results$home_fouls, premier_league_results$away_fouls, premier_league_results$home_yellow_cards, premier_league_results$away_yellow_cards, premier_league_results$home_red_cards, premier_league_results$away_red_cards) %>%
  plot_density(ncol = 3)
```


```{r, echo=FALSE}
#might remove
data_frame(premier_league_results$full_time_home_goals, premier_league_results$full_time_away_goals, premier_league_results$home_shots, premier_league_results$away_shots, premier_league_results$home_fouls, premier_league_results$away_fouls, premier_league_results$home_yellow_cards, premier_league_results$away_yellow_cards, premier_league_results$home_red_cards, premier_league_results$away_red_cards) %>%
  plot_correlation()
```

```{r, echo=FALSE}

```


```{r, echo=FALSE}

```

```{r, echo=FALSE}

```

```{r, echo=FALSE}

```




